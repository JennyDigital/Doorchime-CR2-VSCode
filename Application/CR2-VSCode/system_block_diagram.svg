<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #f6f8fa; stroke: #0366d6; stroke-width: 2; }
      .box-header { fill: #0366d6; stroke: #0366d6; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 14px; fill: #24292e; }
      .text-white { font-family: Arial, sans-serif; font-size: 14px; fill: white; font-weight: bold; }
      .text-small { font-family: Arial, sans-serif; font-size: 12px; fill: #24292e; }
      .arrow { stroke: #0366d6; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .list-text { font-family: Arial, sans-serif; font-size: 11px; fill: #24292e; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#0366d6" />
    </marker>
  </defs>
  
  <!-- Audio Sample (Flash Memory) -->
  <rect x="100" y="20" width="400" height="60" class="box"/>
  <text x="300" y="45" text-anchor="middle" class="text" font-weight="bold">Audio Sample (Flash Memory)</text>
  <text x="300" y="65" text-anchor="middle" class="text-small">(8-bit PCM or 16-bit WAV format)</text>
  
  <!-- Arrow -->
  <line x1="300" y1="80" x2="300" y2="110" class="arrow"/>
  
  <!-- PlaySample() -->
  <rect x="180" y="110" width="240" height="60" class="box"/>
  <text x="300" y="135" text-anchor="middle" class="text" font-weight="bold">PlaySample()</text>
  <text x="300" y="155" text-anchor="middle" class="text-small">Configuration</text>
  
  <!-- Arrow -->
  <line x1="300" y1="170" x2="300" y2="200" class="arrow"/>
  
  <!-- Sample Pointer / DMA Setup -->
  <rect x="180" y="200" width="240" height="70" class="box"/>
  <text x="300" y="225" text-anchor="middle" class="text">Sample Pointer</text>
  <text x="300" y="245" text-anchor="middle" class="text">DMA Setup</text>
  <text x="300" y="262" text-anchor="middle" class="text">I2S Init</text>
  
  <!-- Arrow -->
  <line x1="300" y1="270" x2="300" y2="300" class="arrow"/>
  
  <!-- DMA Half-Buffer Done -->
  <rect x="140" y="300" width="320" height="60" class="box"/>
  <text x="300" y="325" text-anchor="middle" class="text">DMA Half-Buffer Done</text>
  <text x="300" y="345" text-anchor="middle" class="text">â†’ ProcessNextChunk()</text>
  
  <!-- Arrow -->
  <line x1="300" y1="360" x2="300" y2="390" class="arrow"/>
  
  <!-- Per-Sample DSP Filter Chain -->
  <rect x="100" y="390" width="400" height="30" class="box-header"/>
  <text x="300" y="410" text-anchor="middle" class="text-white">Per-Sample DSP Filter Chain</text>
  
  <rect x="100" y="420" width="400" height="140" class="box"/>
  <text x="120" y="440" class="list-text">1. DC Blocking (high-pass)</text>
  <text x="120" y="463" class="list-text">2. Low-Pass Filter (configurable)</text>
  <text x="120" y="486" class="list-text">3. Soft Clipping</text>
  <text x="120" y="509" class="list-text">4. Fade In/Out</text>
  <text x="120" y="532" class="list-text">5. Noise Gate (optional)</text>
  <text x="120" y="555" class="list-text">6. Volume Scaling</text>
  
  <!-- Arrow -->
  <line x1="300" y1="560" x2="300" y2="590" class="arrow"/>
  
  <!-- I2S DMA Buffer -->
  <rect x="180" y="590" width="240" height="60" class="box"/>
  <text x="300" y="615" text-anchor="middle" class="text" font-weight="bold">I2S DMA Buffer</text>
  <text x="300" y="635" text-anchor="middle" class="text-small">(to digital amplifier)</text>
</svg>
